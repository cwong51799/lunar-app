{"version":3,"sources":["components/Checkout.js","components/Success.js","components/Canceled.js","index.js"],"names":["fetchCheckoutSession","a","quantity","fetch","method","headers","body","JSON","stringify","then","res","json","formatPrice","amount","currency","numberFormat","Intl","NumberFormat","style","currencyDisplay","parts","formatToParts","zeroDecimalCurrency","type","total","toFixed","format","reducer","state","action","payload","price","unitAmount","loading","error","Error","Checkout","useReducer","stripe","dispatch","useEffect","publicKey","loadStripe","fetchConfig","handleClick","event","sessionId","redirectToCheckout","className","src","width","height","id","min","max","value","readOnly","role","onClick","disabled","message","Success","useState","session","setSession","useLocation","search","replace","fetchSession","to","alt","Canceled","class","App","path","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.3f8adfdc.chunk.js","sourcesContent":["import React, { useEffect, useReducer } from 'react';\nimport { loadStripe } from '@stripe/stripe-js';\n\nconst fetchCheckoutSession = async ({ quantity }) => {\n  return fetch('/create-checkout-session', {\n    method: 'POST',\n    headers: {\n      'Content-Type': 'application/json',\n    },\n    body: JSON.stringify({\n      quantity,\n    }),\n  }).then((res) => res.json());\n};\n\nconst formatPrice = ({ amount, currency, quantity }) => {\n  const numberFormat = new Intl.NumberFormat('en-US', {\n    style: 'currency',\n    currency,\n    currencyDisplay: 'symbol',\n  });\n  const parts = numberFormat.formatToParts(amount);\n  let zeroDecimalCurrency = true;\n  for (let part of parts) {\n    if (part.type === 'decimal') {\n      zeroDecimalCurrency = false;\n    }\n  }\n  amount = zeroDecimalCurrency ? amount : amount / 100;\n  const total = (quantity * amount).toFixed(2);\n  return numberFormat.format(total);\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'useEffectUpdate':\n      return {\n        ...state,\n        ...action.payload,\n        price: formatPrice({\n          amount: action.payload.unitAmount,\n          currency: action.payload.currency,\n          quantity: state.quantity,\n        }),\n      };\n    case 'increment':\n      return {\n        ...state,\n        quantity: state.quantity + 1,\n        price: formatPrice({\n          amount: state.unitAmount,\n          currency: state.currency,\n          quantity: state.quantity + 1,\n        }),\n      };\n    case 'decrement':\n      return {\n        ...state,\n        quantity: state.quantity - 1,\n        price: formatPrice({\n          amount: state.unitAmount,\n          currency: state.currency,\n          quantity: state.quantity - 1,\n        }),\n      };\n    case 'setLoading':\n      return { ...state, loading: action.payload.loading };\n    case 'setError':\n      return { ...state, error: action.payload.error };\n    default:\n      throw new Error();\n  }\n}\n\nconst Checkout = () => {\n  const [state, dispatch] = useReducer(reducer, {\n    quantity: 1,\n    price: null,\n    loading: false,\n    error: null,\n    stripe: null,\n  });\n\n  useEffect(() => {\n    async function fetchConfig() {\n      // Fetch config from our backend.\n      const { publicKey, unitAmount, currency } = await fetch(\n        '/config'\n      ).then((res) => res.json());\n      // Make sure to call `loadStripe` outside of a componentâ€™s render to avoid\n      // recreating the `Stripe` object on every render.\n      dispatch({\n        type: 'useEffectUpdate',\n        payload: { unitAmount, currency, stripe: await loadStripe(publicKey) },\n      });\n    }\n    fetchConfig();\n  }, []);\n\n  const handleClick = async (event) => {\n    // Call your backend to create the Checkout session.\n    dispatch({ type: 'setLoading', payload: { loading: true } });\n    const { sessionId } = await fetchCheckoutSession({\n      quantity: state.quantity,\n    });\n    // When the customer clicks on the button, redirect them to Checkout.\n    const { error } = await state.stripe.redirectToCheckout({\n      sessionId,\n    });\n    // If `redirectToCheckout` fails due to a browser or network\n    // error, display the localized error message to your customer\n    // using `error.message`.\n    if (error) {\n      dispatch({ type: 'setError', payload: { error } });\n      dispatch({ type: 'setLoading', payload: { loading: false } });\n    }\n  };\n\n  return (\n    <div className=\"sr-root\">\n      <div className=\"sr-main\">\n        <section className=\"container\">\n          <div>\n            <h1>Lunar Trading LLC Membership</h1>\n            <h4>One month of membership</h4>\n            <div className=\"pasha-image\">\n              <img\n                src=\"images/logo.jpg\"\n                width=\"140\"\n                height=\"160\"\n              />\n            </div>\n          </div>\n          <div className=\"quantity-setter\">\n            <input\n              type=\"number\"\n              id=\"quantity-input\"\n              min=\"1\"\n              max=\"10\"\n              value={state.quantity}\n              readOnly\n            />\n          </div>\n\n          <button\n            role=\"link\"\n            onClick={handleClick}\n            disabled={!state.stripe || state.loading}\n          >\n            {state.loading || !state.price\n              ? `Loading...`\n              : `Buy for ${state.price}`}\n          </button>\n          <div className=\"sr-field-error\">{state.error?.message}</div>\n        </section>\n      </div>\n    </div>\n  );\n};\n\nexport default Checkout;\n","import React, { useState, useEffect } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\n\nconst Success = () => {\n  const [session, setSession] = useState({});\n  const location = useLocation();\n  const sessionId = location.search.replace('?session_id=', '');\n\n  useEffect(() => {\n    async function fetchSession() {\n      setSession(\n        await fetch('/checkout-session?sessionId=' + sessionId).then((res) =>\n          res.json()\n        )\n      );\n    }\n    fetchSession();\n  }, [sessionId]);\n\n  return (\n    <div className=\"sr-root\">\n      <div className=\"sr-main\">\n        <header className=\"sr-header\">\n          <div className=\"sr-header__logo\"></div>\n        </header>\n        <div className=\"sr-payment-summary completed-view\">\n          <h1>Your payment succeeded</h1>\n          <h4>View CheckoutSession response:</h4>\n        </div>\n        <div className=\"sr-section completed-view\">\n          <div className=\"sr-callout\">\n            <pre>{JSON.stringify(session, null, 2)}</pre>\n          </div>\n          <Link to=\"/\">Restart demo</Link>\n        </div>\n      </div>\n      <div className=\"sr-content\">\n        <div className=\"pasha-image-stack\">\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=1\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=2\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=3\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=4\"\n            width=\"140\"\n            height=\"160\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Success;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst Canceled = () => {\n  return (\n    <div class=\"sr-root\">\n      <div class=\"sr-main\">\n        <div class=\"sr-payment-summary completed-view\">\n          <h1>Your payment was canceled</h1>\n          <h2>Please try again.</h2>\n        </div>\n      </div>\n      <div class=\"sr-content\">\n        <div class=\"pasha-image-stack\">\n          <img\n            src=\"https://picsum.photos/280/320?random=1\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            src=\"https://picsum.photos/280/320?random=2\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            src=\"https://picsum.photos/280/320?random=3\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            src=\"https://picsum.photos/280/320?random=4\"\n            width=\"140\"\n            height=\"160\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Canceled;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nimport Checkout from './components/Checkout';\nimport Success from './components/Success';\nimport Canceled from './components/Canceled';\n\nimport './css/normalize.css';\nimport './css/global.css';\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/success.html\">\n          <Success />\n        </Route>\n        <Route path=\"/canceled.html\">\n          <Canceled />\n        </Route>\n        <Route path=\"/\">\n          <Checkout />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}