{"version":3,"sources":["components/Checkout.js","components/Success.js","components/Canceled.js","index.js"],"names":["fetchCheckoutSession","a","quantity","fetch","method","headers","body","JSON","stringify","then","res","json","formatPrice","amount","currency","numberFormat","Intl","NumberFormat","style","currencyDisplay","parts","formatToParts","zeroDecimalCurrency","type","total","toFixed","format","reducer","state","action","payload","price","unitAmount","loading","error","Error","Checkout","useReducer","stripe","dispatch","useEffect","publicKey","loadStripe","fetchConfig","handleClick","event","sessionId","redirectToCheckout","className","src","width","height","id","min","max","value","readOnly","role","onClick","disabled","message","Success","useState","session","setSession","useLocation","search","replace","fetchSession","to","alt","Canceled","class","App","path","ReactDOM","render","document","getElementById"],"mappings":"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","file":"static/js/main.3f8adfdc.chunk.js","sourcesContent":["import React, { useEffect, useReducer } from 'react';\r\nimport { loadStripe } from '@stripe/stripe-js';\r\n\r\nconst fetchCheckoutSession = async ({ quantity }) => {\r\n  return fetch('/create-checkout-session', {\r\n    method: 'POST',\r\n    headers: {\r\n      'Content-Type': 'application/json',\r\n    },\r\n    body: JSON.stringify({\r\n      quantity,\r\n    }),\r\n  }).then((res) => res.json());\r\n};\r\n\r\nconst formatPrice = ({ amount, currency, quantity }) => {\r\n  const numberFormat = new Intl.NumberFormat('en-US', {\r\n    style: 'currency',\r\n    currency,\r\n    currencyDisplay: 'symbol',\r\n  });\r\n  const parts = numberFormat.formatToParts(amount);\r\n  let zeroDecimalCurrency = true;\r\n  for (let part of parts) {\r\n    if (part.type === 'decimal') {\r\n      zeroDecimalCurrency = false;\r\n    }\r\n  }\r\n  amount = zeroDecimalCurrency ? amount : amount / 100;\r\n  const total = (quantity * amount).toFixed(2);\r\n  return numberFormat.format(total);\r\n};\r\n\r\nfunction reducer(state, action) {\r\n  switch (action.type) {\r\n    case 'useEffectUpdate':\r\n      return {\r\n        ...state,\r\n        ...action.payload,\r\n        price: formatPrice({\r\n          amount: action.payload.unitAmount,\r\n          currency: action.payload.currency,\r\n          quantity: state.quantity,\r\n        }),\r\n      };\r\n    case 'increment':\r\n      return {\r\n        ...state,\r\n        quantity: state.quantity + 1,\r\n        price: formatPrice({\r\n          amount: state.unitAmount,\r\n          currency: state.currency,\r\n          quantity: state.quantity + 1,\r\n        }),\r\n      };\r\n    case 'decrement':\r\n      return {\r\n        ...state,\r\n        quantity: state.quantity - 1,\r\n        price: formatPrice({\r\n          amount: state.unitAmount,\r\n          currency: state.currency,\r\n          quantity: state.quantity - 1,\r\n        }),\r\n      };\r\n    case 'setLoading':\r\n      return { ...state, loading: action.payload.loading };\r\n    case 'setError':\r\n      return { ...state, error: action.payload.error };\r\n    default:\r\n      throw new Error();\r\n  }\r\n}\r\n\r\nconst Checkout = () => {\r\n  const [state, dispatch] = useReducer(reducer, {\r\n    quantity: 1,\r\n    price: null,\r\n    loading: false,\r\n    error: null,\r\n    stripe: null,\r\n  });\r\n\r\n  useEffect(() => {\r\n    async function fetchConfig() {\r\n      // Fetch config from our backend.\r\n      const { publicKey, unitAmount, currency } = await fetch(\r\n        '/config'\r\n      ).then((res) => res.json());\r\n      // Make sure to call `loadStripe` outside of a componentâ€™s render to avoid\r\n      // recreating the `Stripe` object on every render.\r\n      dispatch({\r\n        type: 'useEffectUpdate',\r\n        payload: { unitAmount, currency, stripe: await loadStripe(publicKey) },\r\n      });\r\n    }\r\n    fetchConfig();\r\n  }, []);\r\n\r\n  const handleClick = async (event) => {\r\n    // Call your backend to create the Checkout session.\r\n    dispatch({ type: 'setLoading', payload: { loading: true } });\r\n    const { sessionId } = await fetchCheckoutSession({\r\n      quantity: state.quantity,\r\n    });\r\n    // When the customer clicks on the button, redirect them to Checkout.\r\n    const { error } = await state.stripe.redirectToCheckout({\r\n      sessionId,\r\n    });\r\n    // If `redirectToCheckout` fails due to a browser or network\r\n    // error, display the localized error message to your customer\r\n    // using `error.message`.\r\n    if (error) {\r\n      dispatch({ type: 'setError', payload: { error } });\r\n      dispatch({ type: 'setLoading', payload: { loading: false } });\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"sr-root\">\r\n      <div className=\"sr-main\">\r\n        <section className=\"container\">\r\n          <div>\r\n            <h1>Lunar Trading LLC Membership</h1>\r\n            <h4>One month of membership</h4>\r\n            <div className=\"pasha-image\">\r\n              <img\r\n                src=\"images/logo.jpg\"\r\n                width=\"140\"\r\n                height=\"160\"\r\n              />\r\n            </div>\r\n          </div>\r\n          <div className=\"quantity-setter\">\r\n            <input\r\n              type=\"number\"\r\n              id=\"quantity-input\"\r\n              min=\"1\"\r\n              max=\"10\"\r\n              value={state.quantity}\r\n              readOnly\r\n            />\r\n          </div>\r\n\r\n          <button\r\n            role=\"link\"\r\n            onClick={handleClick}\r\n            disabled={!state.stripe || state.loading}\r\n          >\r\n            {state.loading || !state.price\r\n              ? `Loading...`\r\n              : `Buy for ${state.price}`}\r\n          </button>\r\n          <div className=\"sr-field-error\">{state.error?.message}</div>\r\n        </section>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Checkout;\r\n","import React, { useState, useEffect } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\n\nconst Success = () => {\n  const [session, setSession] = useState({});\n  const location = useLocation();\n  const sessionId = location.search.replace('?session_id=', '');\n\n  useEffect(() => {\n    async function fetchSession() {\n      setSession(\n        await fetch('/checkout-session?sessionId=' + sessionId).then((res) =>\n          res.json()\n        )\n      );\n    }\n    fetchSession();\n  }, [sessionId]);\n\n  return (\n    <div className=\"sr-root\">\n      <div className=\"sr-main\">\n        <header className=\"sr-header\">\n          <div className=\"sr-header__logo\"></div>\n        </header>\n        <div className=\"sr-payment-summary completed-view\">\n          <h1>Your payment succeeded</h1>\n          <h4>View CheckoutSession response:</h4>\n        </div>\n        <div className=\"sr-section completed-view\">\n          <div className=\"sr-callout\">\n            <pre>{JSON.stringify(session, null, 2)}</pre>\n          </div>\n          <Link to=\"/\">Restart demo</Link>\n        </div>\n      </div>\n      <div className=\"sr-content\">\n        <div className=\"pasha-image-stack\">\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=1\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=2\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=3\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            alt=\"\"\n            src=\"https://picsum.photos/280/320?random=4\"\n            width=\"140\"\n            height=\"160\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Success;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nconst Canceled = () => {\n  return (\n    <div class=\"sr-root\">\n      <div class=\"sr-main\">\n        <div class=\"sr-payment-summary completed-view\">\n          <h1>Your payment was canceled</h1>\n          <h2>Please try again.</h2>\n        </div>\n      </div>\n      <div class=\"sr-content\">\n        <div class=\"pasha-image-stack\">\n          <img\n            src=\"https://picsum.photos/280/320?random=1\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            src=\"https://picsum.photos/280/320?random=2\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            src=\"https://picsum.photos/280/320?random=3\"\n            width=\"140\"\n            height=\"160\"\n          />\n          <img\n            src=\"https://picsum.photos/280/320?random=4\"\n            width=\"140\"\n            height=\"160\"\n          />\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Canceled;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { BrowserRouter as Router, Switch, Route } from 'react-router-dom';\n\nimport Checkout from './components/Checkout';\nimport Success from './components/Success';\nimport Canceled from './components/Canceled';\n\nimport './css/normalize.css';\nimport './css/global.css';\n\nfunction App() {\n  return (\n    <Router>\n      <Switch>\n        <Route path=\"/success.html\">\n          <Success />\n        </Route>\n        <Route path=\"/canceled.html\">\n          <Canceled />\n        </Route>\n        <Route path=\"/\">\n          <Checkout />\n        </Route>\n      </Switch>\n    </Router>\n  );\n}\n\nReactDOM.render(<App />, document.getElementById('root'));\n"],"sourceRoot":""}